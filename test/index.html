<!DOCTYPE html>
<html>
  <head>
    <script src="browserfs.js"></script>
    <script src="NarLoader.js"></script>
    <script src="NanikaStorage.js"></script>
    <script src="NanikaStorage.backend.FS.js"></script>
    <script src="WorkerClient.js"></script>
    <script src="URLWorkerClient.js"></script>
    <script src="NativeShioriWorkerClient.js"></script>
    <script src="ShioriLoader.js"></script>
    <script src="KawariWorker.js"></script>
    <script>(function() {
  var dirpath, fs, memfs, path, __window;

  ShioriLoader.shiori_detectors = [
    function(fs, dirpath, shiories) {
      return new Promise(function(resolve) {
        return resolve(new shiories.kawari(fs));
      });
    }
  ];

  __window = {};

  memfs = new BrowserFS.FileSystem.InMemory();

  BrowserFS.initialize(memfs);

  BrowserFS.install(__window);

  fs = __window.require('fs');

  path = __window.require('path');

  dirpath = '/ika/ghost/tes/ghost/master/';

  fs.mkdir('ika');

  fs.mkdir('ika/ghost');

  fs.mkdir('ika/ghost/tes');

  fs.mkdir('ika/ghost/tes/ghost');

  fs.mkdir('ika/ghost/tes/ghost/master');

  fs.writeFileSync(path.join(dirpath, 'kawarirc.kis'), "System.Callback.OnGET: aaaaaaa");

  console.log(fs.readFileSync(path.join(dirpath, 'kawarirc.kis'), {
    encoding: 'utf8'
  }));

  ShioriLoader.detect_shiori(fs, dirpath).then(function(shiori) {
    return shiori.load(dirpath).then(function(ret) {
      return console.log(ret);
    }).then(function() {
      return shiori.request("GET Version SHIORI/2.6");
    }).then(function(ret) {
      return console.log(ret);
    }).then(function() {
      return shiori.request("GET SHIORI/3.0\nID: OnBoot");
    }).then(function(ret) {
      return console.log(ret);
    }).then(function() {
      return shiori.unload();
    }).then(function(ret) {
      return console.log(ret);
    });
  });

}).call(this);

    </script>
  </head>
  <body></body>
</html>